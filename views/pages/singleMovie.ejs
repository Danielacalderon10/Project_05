
<%- include('../partials/head.ejs') %>
<body>
 <%- include('../partials/nav.ejs') %>


 <div class="container" id="movie-details">
     <h1 id = "title"> </h1>
     
 <div class="part2">
      <div class=" box1">
        <div id = "poster"></div>
      </div>
      <div class="box2">
        <div class="box21">
        <p id = "genres" ></p>
        <h4 id = "year">  </h4>
        <p id = "synopsis" ></p>
        <div id="comment-body" class="col s5">
          <% if (typeof comments != 'undefined') { %>
             
                <div>
                  <%   var total = 0;%>
                  <%   for(var ind = 0; ind < comments.length; ind++) {%>
                  <%    total += comments[ind].score/comments.length} %>
                  <% console.log(total)%>
                    <% if (total != 0) { %> 
                  
                  <h5><strong class="stars"> <%= Number(total).toFixed(2) %>  Stars  </strong></h5> 
                  <% }  else{%> 
                   <h5><strong class="stars"> This movie hasn't been rated </strong></h5> 
                   <%} %>
                </div>
              
            <% } %>
        </div>
      </div>
      <div class="box22">
        <p class="allcomments"><strong>Give us a comment:</strong></p>
        <form id="comment-form" method="POST" action="/movies/<%= movie_id %> ">
          <div id ="comments">
          <div class ="score">
            <label for="score"> Score </label>
            <select name="score" id="score" class="score" required>
              <option value = "" > movies score  </option>
              <option value = 1 > &#9733; &#9734; &#9734; &#9734; &#9734; </option>
              <option value = 2 > &#9733; &#9733; &#9734; &#9734; &#9734; </option>
              <option value = 3 > &#9733; &#9733; &#9733; &#9734; &#9734;</option>
              <option value = 4 > &#9733; &#9733; &#9733; &#9733; &#9734;</option>
              <option value = 5 > &#9733; &#9733; &#9733; &#9733; &#9733;</option>
            </select>
            </div><br> 
            
          <!-- <div class="input-field ">  
              <input id="score" type="text" name="score" />
              <label class="active" for="score">Score the movie from 1 to 5</label>
             </div> -->

           <div class="input-field ">  
           <input id="comment" type="text" name="comment" />
           <label class="active" for="comment">Write comment here:</label>
          </div>
           
           <button
                class="btn waves-effect left-align indigo darken-4"
                type="submit"
                name="action"
                >
                Submit
            </button>
          </div>
        </div>
         </form>
         
         <div id="comment-body" class="col s5">
          <p class="allcomments"><strong>All comments</strong></p>
          <% if (typeof comments != 'undefined') { %>
              <% const commentLimit = comments.length > 7 ? 7 : comments.length %>
              <% for (let i = 0; i < commentLimit; i++) { %>
                <div>
                  <p><strong><%= comments[i].comment %></strong></p>
                  <p><%= comments[i].created_at %></p>
                </div>
              <% } %>
            <% } %>
        </div>
       

        </div>
      </div>
      
</div>

       <!-- footer --> 
  <%- include('../partials/footer.ejs') %>
  <script> const movie_id = <%= movie_id %> </script>
      
  <script src="/js/singleMovie.js"></script>
 
  
</body>
</html>